<!DOCTYPE html>
<html>
  <head>
    <title>
      AmbientLightSensor API
    </title>
    <meta charset="utf-8">
    <script src='https://www.w3.org/Tools/respec/respec-w3c-common' class=
    'remove' async>
    </script>
    <script class="remove">
      var respecConfig = {
          specStatus:           "ED",
          shortName:            "ambient-light",
          // publishDate:          "2014-08-28",
          previousPublishDate:  "2014-06-19",
          previousMaturity:     "LC",
          edDraftURI:           "https://w3c.github.io/ambient-light/",
          // crEnd:                "2014-11-01",
          editors:  [
              { name: "Doug Turner", company: "Mozilla Corporation", companyURL: "http://mozilla.com/"},
              { name: "Anssi Kostiainen", company: "Intel", companyURL: "http://intel.com/" },
              { name: "Tobie Langel", company: "Intel", companyURL: "http://intel.com/", note: "from January 2016" }
          ],
          inlineCSS:    true,
          noIDLIn:      true,
          noLegacyStyle: true,
          wg:           "Device APIs Working Group",
          wgURI:        "http://www.w3.org/2009/dap/",
          wgPublicList: "public-device-apis",
          wgPatentURI:  "http://www.w3.org/2004/01/pp-impl/43696/status",
          testSuiteURI: "http://w3c-test.org/ambient-light/",
          scheme:       "https",
          implementationReportURI: "http://www.w3.org/2009/dap/wiki/ImplementationStatus",
          otherLinks: [{
            key: "Revision history",
            data: [{
              value: "https://github.com/w3c/ambient-light/commits/",
              href:  "https://github.com/w3c/ambient-light/commits/"
            }]
          }],
          processVersion: 2015
      };
    </script>
  </head>
  <body>
    <section id="abstract">
      This specification defines a concrete sensor interface to monitor
      the ambient light level or illuminance of the device's environment.
    </section>
    <section class="informative">
      <h2>
        Introduction
      </h2>
      <p>
        The <a>AmbientLightSensor</a> interface provides information about the
        ambient light levels, as detected by the device's light sensor, in
        terms of lux units.
      </p>
      <p>
        The <a href=
        "http://dev.w3.org/csswg/mediaqueries/#light-level">'light-level' media
        feature</a> [[MEDIAQUERIES-4]] provides more granular, less precise,
        information about the ambient light level.
      </p>
    </section>
    <section id="conformance">
      <p>
        This specification defines conformance criteria that apply to a single
        product: the <dfn>user agent</dfn> that implements the interfaces that
        it contains.
      </p>
      <p>
        Implementations that use ECMAScript to implement the APIs defined in
        this specification must implement them in a manner consistent with the
        ECMAScript Bindings defined in the Web IDL specification [[!WEBIDL]],
        as this specification uses that specification and terminology.
      </p>
    </section>
    <section>
      <h2>
        Terminology
      </h2>
      <p>
        The <code><a href=
        "https://w3c.github.io/sensors/#the-sensor-interface">Sensor</a></code>
        interface is defined in [[!GENERIC-SENSOR]].
      </p>
      <p>
        The concepts <dfn><a href=
        "http://dev.w3.org/html5/spec/webappapis.html#queue-a-task">queue a
        task</a></dfn>, and <dfn><a href=
        "http://dev.w3.org/html5/spec/webappapis.html#fire-a-simple-event">fires
        a simple event</a></dfn> are defined in [[!HTML5]].
      </p>
      <p>
        Event constructor behavior is defined in <dfn><a href=
        "http://dom.spec.whatwg.org/#constructing-events">constructing
        events</a></dfn> chapter in [[!DOM4]].
      </p>
      <p>
        The concepts <dfn><a href=
        "http://dom.spec.whatwg.org/#constructing-events">create an
        event</a></dfn> and <dfn><a href=
        "http://dom.spec.whatwg.org/#firing-events">fire an event</a></dfn> are
        defined in [[!DOM4]].
      </p>
      <p>
        The <dfn>current light level</dfn> or illuminance
        is a value that represents
        the ambient light levels around the hosting device
        in lux units.
      </p>
    </section>
    <section class="informative">
      <h2>
        Security and privacy considerations
      </h2>
      <p>
        There are no specific security and privacy considerations
        beyond those describe in the Generic Sensor API [[GENERIC-SENSOR]].
      </p>
    </section>
    <section>
      <h2>
        Model
      </h2>
      <section>
        <h2>
          <a>AmbientLightSensor</a> Interface
        </h2>
        <pre class="idl">
          [Constructor(optional SensorOptions sensorOptions)]
          interface AmbientLightSensor : Sensor {
            readonly attribute AmbientLightSensorReading? reading;
          };

          interface AmbientLightSensorReading : SensorReading {
              readonly attribute unrestricted double illuminance;
          };
        </pre>
        <p>
          The <dfn>illuminance</dfn> attribute of the <a>AmbientLightSensorReading</a>
          interface represents the <a>current light level</a>.
        </p>
        <div class="note">
          The precise lux value reported by different devices in the same light
          can be different, due to differences in detection method, sensor
          construction etc.
        </div>
        <p>
          When a <a>user agent</a> is required to <dfn>fire a change
          event</dfn> on an <a>AmbientLightSensor</a> object,
          the <a>user agent</a> MUST run the following steps:
        </p>
        <ol class="rule">
          <li>
            <a>Create an event</a> that uses the <a>AmbientLightSensorReading</a>
            interface, with the name <a>change</a>, which does not bubbles, is not
            cancelable, and has no default action, that also meets the
            following conditions:
            <ol>
              <li>If the implementation is unable to report the <a>current
              light level</a>, initialize the <a>illuminance</a> attribute to
              null, otherwise initialize the attribute to the
              <a>current light level</a>.
              </li>
            </ol>
          </li>
        </ol>
        <p>
          When the <a>current light level</a> changes, the <a>user agent</a>
          MUST queue a task to <a>fire a change event</a> at all the existing
          <a>AmbientLightSensor</a> objects.
        </p>
        <div class="note">
          The definition of granularity i.e. how often the event is fired is
          left to the implementation. Implementations can fire the event if
          they have reason to believe that the page does not have sufficiently
          fresh data.
        </div>
      </section>
    </section>
    <section class="appendix">
      <h2>
        Acknowledgements
      </h2>
      <p>
        Doug Turner for the initial prototype and Marcos Caceres for the test
        suite.
      </p>
    </section>
  </body>
</html>
